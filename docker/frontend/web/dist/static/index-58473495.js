import{x as O,r as Z,z as G,A as Q,B as W,E as D}from"./element-0afb0e99.js";import{n as X,u as Y,o as ee,p as te}from"./index-46bdc1ae.js";import{a as ae,g as le}from"./state-c5255287.js";import{p as oe,r as c,Z as ne,ai as n,aq as se,q as z,t as ie,P as U,M as A,O as o,v as p,U as e,u as g,S as k,I as re,T as ce}from"./vue-956193f0.js";/* empty css                                                       */import{_ as ue}from"./index-35ab6744.js";import"./vxe-78a23074.js";const pe={class:"app-container"},de={class:"toolbar-wrapper"},_e={class:"table-wrapper"},me={class:"demo-pagination-block"},ge=oe({__name:"index",setup(fe){const d=c(!1),I=c(!1),f=c(),w=c(10),C=c(1),y=c(0),h=c(0),u={pageSize:20,pageNum:1},i=ne({hostname:"",state:"-1"}),_=()=>{d.value=!0,X(u).then(a=>{const{pageSize:t,pageNum:m,total:s,pages:v,list:S}=a.data;f.value=S,w.value=t,y.value=v,C.value=m,h.value=s}).catch(()=>{f.value=[]}).finally(()=>{d.value=!1})};_();const x=c();function R(a,t){Y(a,t).then(m=>{})}function T(){const a=[];for(const t of x.value)a.push(t.agentId);W.confirm("确定删除?","警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",center:!0}).then(()=>{D({type:"success",message:"删除成功"}),d.value=!0,ee(a.join(",")).then(()=>{_()}).finally(()=>{d.value=!1})}).catch(()=>{D({type:"info",message:"删除取消"})})}const q=a=>{x.value=a},E=a=>{u.pageSize=a,_()},j=a=>{u.pageNum=a,_()},M=a=>{};function P(){const a=i.hostname,t=i.state;if(t=="-1"&&a==""){_();return}te(a,t).then(m=>{const s=m.data;f.value=s.list,w.value=s.pageSize,y.value=s.pages,C.value=s.pageNum,h.value=s.total}).catch(()=>{f.value=[],w.value=0,y.value=0,C.value=0,h.value=0})}const L=()=>{i.hostname="",i.state="-1"};return(a,t)=>{const m=n("el-input"),s=n("el-form-item"),v=n("el-option"),S=n("el-select"),b=n("el-button"),$=n("el-form"),V=n("el-card"),F=n("el-tooltip"),r=n("el-table-column"),H=n("el-switch"),J=n("el-table"),K=n("el-pagination"),N=se("loading");return z(),ie("div",pe,[U((z(),A(V,{class:"search-wrapper"},{default:o(()=>[p("div",null,[e($,{ref:"searchFormRef",inline:!0,model:i},{default:o(()=>[e(s,{prop:"hostname",label:"服务器名称"},{default:o(()=>[e(m,{modelValue:i.hostname,"onUpdate:modelValue":t[0]||(t[0]=l=>i.hostname=l),placeholder:"请输入"},null,8,["modelValue"])]),_:1}),e(s,{prop:"state",label:"状态"},{default:o(()=>[e(S,{modelValue:i.state,"onUpdate:modelValue":t[1]||(t[1]=l=>i.state=l),style:{width:"84px"}},{default:o(()=>[e(v,{label:"所有",value:"-1"}),e(v,{label:"在线",value:"1"}),e(v,{label:"离线",value:"0"})]),_:1},8,["modelValue"])]),_:1}),e(s,null,{default:o(()=>[e(b,{type:"primary",icon:g(O),onClick:t[2]||(t[2]=l=>P())},{default:o(()=>[k("查询")]),_:1},8,["icon"]),e(b,{icon:g(Z),onClick:L},{default:o(()=>[k("重置")]),_:1},8,["icon"])]),_:1})]),_:1},8,["model"])])]),_:1})),[[N,d.value]]),U((z(),A(V,null,{default:o(()=>[p("div",de,[p("div",null,[e(b,{type:"danger",icon:g(G),onClick:T},{default:o(()=>[k("批量删除")]),_:1},8,["icon"])]),p("div",null,[e(F,{content:"刷新当前页"},{default:o(()=>[e(b,{type:"primary",icon:g(Q),circle:"",onClick:_},null,8,["icon"])]),_:1})])]),p("div",_e,[e(J,{ref:"multipleTableRef",data:f.value,border:"",style:{width:"100%"},"default-sort":{prop:"timestamp",order:"descending"},onSelectionChange:q,onRowClick:M},{default:o(()=>[e(r,{type:"selection",width:"55"}),e(r,{label:"ID",prop:"agentId",width:"320"}),e(r,{width:"240",prop:"hostname",label:"服务器名称",sortable:""}),e(r,{label:"应用路径",prop:"serverPath"}),e(r,{label:"Agent版本",prop:"version",width:"100"}),e(r,{label:"JDK",prop:"jdkVersion",width:"80"}),e(r,{prop:"state",width:"120",label:"运行状态",align:"center",sortable:""},{default:o(l=>[p("span",{class:re(g(ae)(l.row.state))},ce(g(le)(l.row.state)),3)]),_:1}),e(r,{prop:"state",width:"120",label:"检测状态",align:"center",sortable:""},{default:o(l=>[e(H,{modelValue:l.row.detectionStatus,"onUpdate:modelValue":B=>l.row.detectionStatus=B,"active-value":1,"inactive-value":0,"active-color":"#13ce66","inactive-color":"#ff4949",onClick:B=>R(l.row.agentId,l.row.detectionStatus)},null,8,["modelValue","onUpdate:modelValue","onClick"])]),_:1}),e(r,{prop:"timestamp",width:"200",label:"最近活跃时间",sortable:""})]),_:1},8,["data"])]),p("div",me,[e(K,{"current-page":u.pageNum,"onUpdate:currentPage":t[3]||(t[3]=l=>u.pageNum=l),"page-size":u.pageSize,"onUpdate:pageSize":t[4]||(t[4]=l=>u.pageSize=l),"page-sizes":[10,20,50,100],small:!1,disabled:I.value,background:!0,layout:"total, sizes, prev, pager, next, jumper",total:h.value,onSizeChange:E,onCurrentChange:j},null,8,["current-page","page-size","disabled","total"])])]),_:1})),[[N,d.value]])])}}});const ze=ue(ge,[["__scopeId","data-v-21b580fc"]]);export{ze as default};
