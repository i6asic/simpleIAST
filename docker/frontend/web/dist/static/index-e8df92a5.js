import{r as i,p as ue,Z as E,b as re,ai as s,aq as de,q as c,t as A,U as a,O as n,v as g,S as r,F as K,a8 as $,u,R as pe,M as b,D as ce,a9 as me,P as M,T as B}from"./vue-956193f0.js";import{x as _e,r as fe,y as ge,z as ve,A as be,E as k}from"./element-12e92669.js";import{g as he,k as ye,l as Ce,m as we}from"./index-110ed2a8.js";import{l as ke,g as O}from"./level-5fc919ec.js";/* empty css                                                       */import{_ as Ve}from"./index-e50c813d.js";import"./vxe-c7146e14.js";const h=i(""),I=i(!1);i();const ze=()=>{I.value=!0},xe={class:"app-container"},Se={class:"dialog-footer"},De={class:"toolbar-wrapper"},Ne={class:"table-wrapper"},Re={class:"demo-pagination-block"},F="60px",Ue=ue({__name:"index",setup(Ae){const V=i(!1),P=i(!1),y=i(),x=i(10),S=i(1),D=i(0),z=i(0),d={pageSize:20,pageNum:1},C=E({name:""}),m=()=>{V.value=!0,he(d).then(t=>{const{pageSize:e,pageNum:_,total:f,pages:R,list:U}=t.data;y.value=U,x.value=e,D.value=R,S.value=_,z.value=f}).catch(()=>{y.value=[]}).finally(()=>{V.value=!1})};m();const N=i(),W=t=>{N.value=t};function Z(){N.value==null&&k.warning("请选择删除应用");let t=[];for(const e of N.value)t.push(e.id);ye(t.join(",")).then(()=>{k.info("删除"+t.length+"个应用成功")}).catch(()=>{k.warning("删除"+t.length+"个应用失败")}).finally(()=>{m()})}const w=i(!1),o=E({id:1,name:"",tag:"",level:1,agents:[]});function G(){w.value=!1,Ce(o).catch(()=>{k.warning("添加应用失败")}).finally(()=>{m(),k.success("添加应用成功")})}function H(){w.value=!0}re([()=>d.pageNum,()=>d.pageSize],m,{immediate:!0});const J=t=>{d.pageSize=t,m()};function Q(t){let e=[];o.tag!=""&&(e=o.tag.split(",")),e=e.filter(_=>_!==t),o.tag=e.join(",")}function L(){let t;h.value&&(o.tag==""?t=[]:t=o.tag.split(","),t.push(h.value),o.tag=t.join(",")),I.value=!1,h.value=""}const X=t=>{d.pageNum=t,m()},Y=t=>{};function ee(t){if(t==null||t==""){m();return}we(t).then(e=>{y.value=[e.data],x.value=1,D.value=1,S.value=1,z.value=1}).catch(()=>{y.value=[],x.value=0,D.value=0,S.value=0,z.value=0})}const le=()=>{C.name=""};function ae(t,e){return t.id!=1}return(t,e)=>{const _=s("el-input"),f=s("el-form-item"),R=s("el-option"),U=s("el-select"),te=s("el-tag"),p=s("el-button"),j=s("el-form"),ne=s("el-dialog"),q=s("el-card"),oe=s("el-tooltip"),v=s("el-table-column"),se=s("el-table"),ie=s("el-pagination"),T=de("loading");return c(),A("div",xe,[a(ne,{modelValue:w.value,"onUpdate:modelValue":e[4]||(e[4]=l=>w.value=l),title:"添加应用"},{footer:n(()=>[g("span",Se,[a(p,{onClick:e[3]||(e[3]=l=>w.value=!1)},{default:n(()=>[r("取消")]),_:1}),a(p,{type:"primary",onClick:G},{default:n(()=>[r(" 确认 ")]),_:1})])]),default:n(()=>[a(j,{model:o},{default:n(()=>[a(f,{label:"应用名","label-width":F},{default:n(()=>[a(_,{modelValue:o.name,"onUpdate:modelValue":e[0]||(e[0]=l=>o.name=l),autocomplete:"off"},null,8,["modelValue"])]),_:1}),a(f,{label:"重要性","label-width":F},{default:n(()=>[a(U,{modelValue:o.level,"onUpdate:modelValue":e[1]||(e[1]=l=>o.level=l)},{default:n(()=>[(c(!0),A(K,null,$(u(ke),l=>(c(),b(R,{label:u(O)(l.value),value:l.value,key:l.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),a(f,{label:"标签","label-width":F},{default:n(()=>[o.tag?(c(!0),A(K,{key:0},$(o.tag.split(","),l=>(c(),b(te,{key:l,class:"mx-1",closable:"","disable-transitions":!1,onClose:Be=>Q(l)},{default:n(()=>[r(B(l),1)]),_:2},1032,["onClose"]))),128)):pe("",!0),u(I)?(c(),b(_,{key:1,ref:"InputRef",modelValue:u(h),"onUpdate:modelValue":e[2]||(e[2]=l=>ce(h)?h.value=l:null),class:"ml-1 w-20",size:"small",onKeyup:me(L,["enter"]),onBlur:L},null,8,["modelValue","onKeyup"])):(c(),b(p,{key:2,class:"button-new-tag ml-1",size:"small",onClick:u(ze)},{default:n(()=>[r(" + 标签 ")]),_:1},8,["onClick"]))]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"]),a(q,{shadow:"never",class:"search-wrapper"},{default:n(()=>[a(j,{ref:"searchFormRef",inline:!0,model:C},{default:n(()=>[a(f,{prop:"username",label:"应用名"},{default:n(()=>[a(_,{modelValue:C.name,"onUpdate:modelValue":e[5]||(e[5]=l=>C.name=l),placeholder:"请输入"},null,8,["modelValue"])]),_:1}),a(f,null,{default:n(()=>[a(p,{type:"primary",icon:u(_e),onClick:e[6]||(e[6]=l=>ee(C.name))},{default:n(()=>[r("查询")]),_:1},8,["icon"]),a(p,{icon:u(fe),onClick:le},{default:n(()=>[r("重置")]),_:1},8,["icon"])]),_:1})]),_:1},8,["model"])]),_:1}),M((c(),b(q,null,{default:n(()=>[g("div",De,[g("div",null,[a(p,{type:"primary",icon:u(ge),onClick:H},{default:n(()=>[r("新增应用")]),_:1},8,["icon"]),a(p,{type:"danger",icon:u(ve),onClick:Z},{default:n(()=>[r("批量删除")]),_:1},8,["icon"])]),g("div",null,[a(oe,{content:"刷新当前页"},{default:n(()=>[a(p,{type:"primary",icon:u(be),circle:"",onClick:m},null,8,["icon"])]),_:1})])]),g("div",Ne,[M((c(),b(se,{ref:"multipleTableRef",data:y.value,border:"",style:{width:"100%"},onSelectionChange:W,onRowClick:Y},{default:n(()=>[a(v,{selectable:ae,type:"selection",width:"55"}),a(v,{label:"ID",prop:"id",width:60}),a(v,{prop:"name",label:"应用名",sortable:""}),a(v,{prop:"level",label:"重要性",align:"center",sortable:""},{default:n(l=>[g("span",null,B(u(O)(l.row.level)),1)]),_:1}),a(v,{label:"Agent数量"},{default:n(l=>[r(B(l.row.agents.length),1)]),_:1}),a(v,{label:"选项",prop:""},{default:n(l=>[a(p,{type:"info",round:"",size:"small"},{default:n(()=>[r("详情")]),_:1})]),_:1})]),_:1},8,["data"])),[[T,V.value]])]),g("div",Re,[a(ie,{"current-page":d.pageNum,"onUpdate:currentPage":e[7]||(e[7]=l=>d.pageNum=l),"page-size":d.pageSize,"onUpdate:pageSize":e[8]||(e[8]=l=>d.pageSize=l),"page-sizes":[10,20,50,100],small:!1,disabled:P.value,background:!0,layout:"total, sizes, prev, pager, next, jumper",total:z.value,onSizeChange:J,onCurrentChange:X},null,8,["current-page","page-size","disabled","total"])])]),_:1})),[[T,V.value]])])}}});const Ke=Ve(Ue,[["__scopeId","data-v-06c0de0e"]]);export{Ke as default};
