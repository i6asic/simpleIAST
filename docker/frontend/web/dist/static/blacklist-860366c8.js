import{x as W,r as Z,y as G,z as J,A as K,E as C,B as Q}from"./element-0afb0e99.js";import{y as X,z as Y,A as $,B as ee}from"./index-46bdc1ae.js";import{p as ae,r as s,Z as D,ai as i,q as te,t as le,U as e,O as a,v as o,S as p,u as v,aH as oe,aI as ne}from"./vue-956193f0.js";import{_ as se}from"./index-35ab6744.js";import"./vxe-78a23074.js";const ie=h=>(oe("data-v-179706ba"),h=h(),ne(),h),ce={class:"setting-container"},ue=ie(()=>o("div",{class:"tip custom-block"},[o("p",{class:"custom-block-title"},"说明"),o("p",null,"设置agent绑定的主机名黑名单，黑名单主机名将禁止向服务端注册，也不会进行漏洞探测操作。"),o("p",null,"黑名单主机名支持模糊匹配")],-1)),re={class:"dialog-footer"},de={class:"toolbar-wrapper"},pe={class:"table-wrapper"},me={class:"demo-pagination-block"},_e="100px",fe=ae({__name:"blacklist",setup(h){const x=s(),b=s(!1),L=s(!1),m=s(),z=s(10),S=s(1),w=s(0),y=s(0),r={pageSize:20,pageNum:1},B=D({name:""});function U(){_.value=!1,X(B).then(()=>{C.success("添加黑名单成功")}).catch(()=>{C.warning("添加黑名单失败")}).finally(()=>{d()})}const _=s(!1);function I(){_.value=!0}function T(){_.value=!1}const E=l=>{x.value=l},f=D({name:""});s("1");const d=()=>{b.value=!0,Y(r).then(l=>{const{pageSize:t,pageNum:n,total:g,pages:k,list:c}=l.data;m.value=c,z.value=t,w.value=k,S.value=n,y.value=g}).catch(()=>{m.value=[]}).finally(()=>{b.value=!1})};function R(){let l=[];for(const t of x.value)l.push(t.name);Q.confirm("确定删除?","警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",center:!0}).then(()=>{C({type:"success",message:"删除成功"}),b.value=!0,$(l.join(",")).then(()=>{d()}).finally(()=>{b.value=!1})}).catch(()=>{C({type:"info",message:"删除失败"})})}d();const q=l=>{r.pageSize=l,d()},F=l=>{r.pageNum=l,d()};function j(){let l=f.name;if(l==null||l==""){d();return}ee(l).then(t=>{let n=t.data;m.value=n.list,z.value=n.pageSize,w.value=n.pages,S.value=n.pageNum,y.value=n.total}).catch(()=>{m.value=[],z.value=0,w.value=0,S.value=0,y.value=0})}const A=()=>{f.name=""};return(l,t)=>{const n=i("el-input"),g=i("el-form-item"),k=i("el-form"),c=i("el-button"),M=i("el-dialog"),N=i("el-card"),H=i("el-tooltip"),V=i("el-table-column"),O=i("el-table"),P=i("el-pagination");return te(),le("div",ce,[ue,e(M,{modelValue:_.value,"onUpdate:modelValue":t[1]||(t[1]=u=>_.value=u),title:"添加黑名单"},{footer:a(()=>[o("div",re,[e(c,{onClick:T},{default:a(()=>[p("取消")]),_:1}),e(c,{type:"primary",onClick:U},{default:a(()=>[p(" 确认 ")]),_:1})])]),default:a(()=>[e(k,null,{default:a(()=>[e(g,{label:"主机名称","label-width":_e},{default:a(()=>[e(n,{autocomplete:"off",modelValue:B.name,"onUpdate:modelValue":t[0]||(t[0]=u=>B.name=u)},null,8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(N,{shadow:"never",class:"search-wrapper"},{default:a(()=>[o("div",null,[e(k,{ref:"searchFormRef",inline:!0,model:f},{default:a(()=>[e(g,{prop:"hostName",label:"主机名称"},{default:a(()=>[e(n,{placeholder:"请输入",modelValue:f.name,"onUpdate:modelValue":t[2]||(t[2]=u=>f.name=u)},null,8,["modelValue"])]),_:1}),e(g,null,{default:a(()=>[e(c,{type:"primary",icon:v(W),onClick:j},{default:a(()=>[p("查询")]),_:1},8,["icon"]),e(c,{icon:v(Z),onClick:A},{default:a(()=>[p("重置")]),_:1},8,["icon"])]),_:1})]),_:1},8,["model"])])]),_:1}),e(N,{shadow:"never"},{default:a(()=>[o("div",de,[o("div",null,[e(c,{type:"primary",icon:v(G),onClick:I},{default:a(()=>[p("新增黑名单")]),_:1},8,["icon"]),e(c,{type:"danger",icon:v(J),onClick:R},{default:a(()=>[p("批量删除")]),_:1},8,["icon"])]),o("div",null,[e(H,{content:"刷新当前页"},{default:a(()=>[e(c,{type:"primary",icon:v(K),circle:"",onClick:d},null,8,["icon"])]),_:1})])]),o("div",pe,[e(O,{ref:"multipleTableRef",data:m.value,style:{width:"100%"},onSelectionChange:E},{default:a(()=>[e(V,{type:"selection",width:"55"}),e(V,{prop:"id",label:"id",align:"left"}),e(V,{prop:"name",label:"主机名称",align:"left",sortable:""})]),_:1},8,["data"])]),o("div",me,[e(P,{"current-page":r.pageNum,"onUpdate:currentPage":t[3]||(t[3]=u=>r.pageNum=u),"page-size":r.pageSize,"onUpdate:pageSize":t[4]||(t[4]=u=>r.pageSize=u),"page-sizes":[10,20,50,100],small:!1,disabled:L.value,background:!0,layout:"total, sizes, prev, pager, next, jumper",total:y.value,onSizeChange:q,onCurrentChange:F},null,8,["current-page","page-size","disabled","total"])])]),_:1})])}}});const ke=se(fe,[["__scopeId","data-v-179706ba"]]);export{ke as default};
