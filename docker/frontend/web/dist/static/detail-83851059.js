import{p as X,r as T,aE as Y,ai as s,q as o,M as x,O as e,U as t,t as h,I as A,u as E,T as u,R as b,S as _,v as i,F as ee,a8 as te}from"./vue-956193f0.js";import{a as le,g as ae}from"./level-f8ca1491.js";import{p as ne,a as oe,b as se}from"./level.css_vue_type_style_index_0_src_true_lang-fb9792d3.js";import{q as ue}from"./index-110ed2a8.js";import{E as q}from"./element-12e92669.js";import"./index-e50c813d.js";import"./vxe-c7146e14.js";function F(k){const n=Object.entries(k).sort(([l],[r])=>l==="host"||l==="referer"?-1:r==="host"||r==="referer"?1:l.localeCompare(r));let m="";return n.forEach(([l,r])=>{l=l.replace(/(?:^|-)([a-z])/g,g=>g.toUpperCase()),m=m+l+": "+r+`\r
`}),m}function re(k,n,m,l,r){let g=F(m);n=n.toUpperCase();let w=`${n} ${k} ${r}\r
`;return w+=g,l!=null&&(w+=`\r
${atob(l)}`),w}function ce(k,n,m){let l=F(m);return`${k} ${n}\r
${l}`}const ie={key:0},de={key:1},_e={key:2},pe={class:"custom-label"},fe={key:0},ve={class:"custom-parent-label"},me=i("hr",null,null,-1),he={class:"parent-node-sign"},be={class:"left-content"},ge={class:"right-content"},ye={key:1},xe={style:{display:"inline-block","font-weight":"bold",width:"80px","text-align":"right"}},ke={style:{display:"inline-block","background-color":"#dedfe080",width:"100%","padding-left":"10px","border-radius":"5px"}},we={key:2},Te={class:"http-container"},Ve={class:"http-left-pane"},Ce=i("h3",null,"HTTP请求",-1),qe={class:"http-right-pane"},Re=i("h3",null,"HTTP响应",-1),Ue=X({__name:"detail",setup(k){const n=T(),m=Y(),l=T(),r=T(),g=T(),w=T("first"),y=T(),B=()=>new Promise((a,c)=>{ue(m.currentRoute.value.params.id).then(d=>{y.value=d.data,a(d.data)}).catch(d=>{c(d)})});function I(){navigator.clipboard.writeText(r.value).then(()=>{q.success("文本已成功复制到剪贴板")}).catch(a=>{q.error("复制到剪贴板失败: "+a.message)})}function M(){navigator.clipboard.writeText(g.value).then(()=>{q.success("文本已成功复制到剪贴板")}).catch(a=>{q.error("复制到剪贴板失败: "+a.message)})}function O(){return y.value}async function z(){try{await B(),j()}catch(a){console.error("获取数据失败:",a)}}function j(){const a=O(),c=JSON.parse(a.findingData);let d=[];const f=c.vulnerableType;if(f=="hard_code")n.value=2,d=ne(c);else if(f=="weak_password_in_sql")n.value=3,d=oe(c),H(a);else{n.value=1;const C=c.flowData;d=se(C),H(a)}l.value=d}function H(a){r.value=re(a.url,a.requestMethod,a.requestHeader,a.requestBody,a.protocol),g.value=ce(a.protocol,a.statusCode,a.responseHeader)}return z(),(a,c)=>{const d=s("el-header"),f=s("el-text"),C=s("el-tooltip"),L=s("el-row"),J=s("el-element"),Q=s("el-collapse-item"),W=s("el-collapse"),Z=s("el-tree"),V=s("el-table-column"),N=s("el-table"),R=s("el-main"),D=s("el-container"),S=s("el-tab-pane"),$=s("el-input"),P=s("el-button"),G=s("el-tabs");return o(),x(D,null,{default:e(()=>[t(d,null,{default:e(()=>[y.value?(o(),h("h3",ie,[y.value?(o(),h("span",{key:0,class:A(E(le)(y.value.level)),style:{"margin-right":"10px"}},u(E(ae)(y.value.level)),3)):b("",!0),n.value==1||n.value==3?(o(),h("span",de,u(y.value.url),1)):n.value==2?(o(),h("span",_e,u(l.value[0].sourceFile),1)):b("",!0),_(" 发现 "+u(y.value.vulnerableTypeZH),1)])):b("",!0)]),_:1}),t(R,null,{default:e(()=>[t(G,{modelValue:w.value,"onUpdate:modelValue":c[2]||(c[2]=p=>w.value=p)},{default:e(()=>[t(S,{label:"漏洞细节",name:"first"},{default:e(()=>[n.value==1?(o(),x(Z,{key:0,indent:16,data:l.value,"node-key":"id"},{default:e(({node:p,data:v})=>[i("div",pe,[p.level==1?(o(),h("div",fe,[i("div",ve,u(v.label),1),me,i("div",he,[i("div",be,u(v.sign),1),i("div",ge,[t(L,{class:"w-600px mb-2"},{default:e(()=>[t(C,{content:v.taint,placement:"top-end"},{default:e(()=>[t(f,{style:{color:"red"},truncated:""},{default:e(()=>[_(u(v.taint),1)]),_:2},1024)]),_:2},1032,["content"])]),_:2},1024)])])])):v.label!="调用栈："?(o(),h("div",ye,[i("div",xe,u(v.label),1),i("div",ke,[t(L,{class:"w-1200px mb-2"},{default:e(()=>[t(C,{content:v.value,placement:"top-end"},{default:e(()=>[t(f,{truncated:""},{default:e(()=>[_(u(v.value),1)]),_:2},1024)]),_:2},1032,["content"])]),_:2},1024)])])):(o(),h("div",we,[t(W,null,{default:e(()=>[t(Q,{title:"调用栈"},{default:e(()=>[v.value?(o(!0),h(ee,{key:0},te(v.value,(U,K)=>(o(),h("div",{key:K},[t(J,{data:U},{default:e(()=>[t(f,{truncated:"",style:{"line-height":"30px","padding-left":"10px","background-color":"rgba(222, 223, 224, 0.5)"}},{default:e(()=>[_(u(U),1)]),_:2},1024)]),_:2},1032,["data"])]))),128)):b("",!0)]),_:2},1024)]),_:2},1024)]))])]),_:1},8,["data"])):n.value==2?(o(),x(D,{key:1},{default:e(()=>[l.value?(o(),x(d,{key:0},{default:e(()=>[_(" 硬编码漏洞存在于 "),t(f,{tag:"b"},{default:e(()=>[_(u(l.value[0].sourceFile),1)]),_:1}),_(" 文件中, 类路径： "),t(f,{tag:"b"},{default:e(()=>[_(u(l.value[0].className),1)]),_:1})]),_:1})):b("",!0),t(R,null,{default:e(()=>[l.value?(o(),x(N,{key:0,data:l.value,style:{width:"100%"}},{default:e(()=>[t(V,{prop:"parameterName",label:"参数名"}),t(V,{label:"参数值"},{default:e(p=>[t(f,null,{default:e(()=>[_(u(p.row.parameterValue),1)]),_:2},1024)]),_:1})]),_:1},8,["data"])):b("",!0)]),_:1})]),_:1})):n.value==3?(o(),x(D,{key:2},{default:e(()=>[t(R,null,{default:e(()=>[l.value?(o(),x(N,{key:0,data:l.value,style:{width:"100%"}},{default:e(()=>[t(V,{prop:"url",label:"数据库连接地址"}),t(V,{prop:"user",label:"用户名"}),t(V,{prop:"password",label:"密码"},{default:e(p=>[t(f,null,{default:e(()=>[_(u(p.row.password),1)]),_:2},1024)]),_:1})]),_:1},8,["data"])):b("",!0)]),_:1})]),_:1})):b("",!0)]),_:1}),n.value==1||n.value==3?(o(),x(S,{key:0,label:"HTTP请求信息",name:"second"},{default:e(()=>[i("div",Te,[i("div",Ve,[Ce,t($,{type:"textarea",modelValue:r.value,"onUpdate:modelValue":c[0]||(c[0]=p=>r.value=p)},null,8,["modelValue"]),t(P,{class:"http-copy-button",onClick:I},{default:e(()=>[_("复制")]),_:1})]),i("div",qe,[Re,t($,{type:"textarea",modelValue:g.value,"onUpdate:modelValue":c[1]||(c[1]=p=>g.value=p)},null,8,["modelValue"]),t(P,{class:"http-copy-button",onClick:M},{default:e(()=>[_("复制")]),_:1})])])]),_:1})):b("",!0)]),_:1},8,["modelValue"])]),_:1})]),_:1})}}});export{Ue as default};
