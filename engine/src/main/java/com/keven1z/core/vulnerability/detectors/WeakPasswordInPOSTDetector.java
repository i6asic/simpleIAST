package com.keven1z.core.vulnerability.detectors;

import com.keven1z.core.consts.VulnerabilityLevel;
import com.keven1z.core.consts.VulnerabilityType;
import com.keven1z.core.vulnerability.AbstractDetector;
import com.keven1z.core.vulnerability.DetectContext;

import java.util.Map;

import static com.keven1z.core.consts.HTTPConst.POST;

public class WeakPasswordInPOSTDetector extends AbstractDetector {
    private String reportDesc;

    public WeakPasswordInPOSTDetector() {
        super(VulnerabilityType.WEAK_PASSWORD_IN_POST, VulnerabilityLevel.LOW);
    }


    @Override
    public boolean detect(DetectContext context) {
        if (!POST.equals(context.getRequestData().getMethod())) {
            return false;
        }
        Map<String, String> responseHeaders = context.getResponseData().getHeaders();
        String contentType = responseHeaders.get("Content-Type") == null ? responseHeaders.get("content-type") : responseHeaders.get("Content-Type");
//        if (HTTPConst.FORM_DATA.equals(contentType)){
//
//        }
        return false;
    }
}
